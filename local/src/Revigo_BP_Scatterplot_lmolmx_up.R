## lmo lmx up 

# A plotting R script produced by the Revigo server at http://revigo.irb.hr/
# If you found Revigo useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800

# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );

# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );

# --------------------------------------------------------------------------
# Here is your data from Revigo. Scroll down for plot configuration options.

revigo.names <- c("term_ID","description","frequency","plot_X","plot_Y","log_size","value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0001101","response to acid chemical",0.72079119405487,-4.12965853136818,-5.20603209403542,2.11394335230684,-1.50493873438631,0.980765393037444,0.27804772),
c("GO:0001501","skeletal system development",2.85522713303906,6.18914892469945,-0.137325378193746,2.70926996097583,-1.66513263189923,0.849733281939207,0.34315712),
c("GO:0001655","urogenital system development",0.357601832709393,7.27318334916989,-0.127901166432541,1.81291335664286,-1.80669428251436,0.877359142339033,0.26952919),
c("GO:0001704","formation of primary germ layer",0.659328379057943,7.11167326822688,0.747817198735596,2.07554696139253,-1.66765981801605,0.844641062007366,0.43335372),
c("GO:0001759","organ induction",0.0838129295412639,1.21178570849454,5.04287869352463,1.20411998265592,-1.46034819096353,0.844837199628477,0.42651999),
c("GO:0002043","blood vessel endothelial cell proliferation involved in sprouting angiogenesis",0.0391127004525898,7.81375894560195,1.37226320820796,0.903089986991944,-2.68190945327638,0.853630310161326,0.14928933),
c("GO:0003009","skeletal muscle contraction",0.162038330446444,6.13669670001993,-4.46235780822803,1.47712125471966,-3.00705965986391,0.877213090913745,0.37216632),
c("GO:0003012","muscle system process",1.57568307537576,6.36243284839046,-3.46320890836147,2.45178643552429,-2.3538545234617,0.874815147382186,0.47876313),
c("GO:0006066","alcohol metabolic process",1.79359669218305,-3.863230804319,-0.492663616358789,2.50785587169583,-2.50646579940273,0.912833549755215,0.07650511),
c("GO:0006721","terpenoid metabolic process",0.558752863608426,3.15856598047205,7.5298964727192,2.00432137378264,-4.93871652837787,0.921199183688071,0),
c("GO:0006775","fat-soluble vitamin metabolic process",0.22350114544337,-4.08751356383728,-0.277907013941472,1.61278385671974,-1.44074489807027,0.944751316170381,0.4270909),
c("GO:0006805","xenobiotic metabolic process",0.653740850421858,-4.39619349539072,-4.70487289246834,2.07188200730613,-4.34507366854899,0.956740273588209,0.08884652),
c("GO:0006814","sodium ion transport",1.14544337039727,0.213648897409424,-6.46460524745828,2.31386722036915,-3.54876547373269,0.927979807884244,0),
c("GO:0006833","water transport",0.139688215902106,-0.511811852879002,-6.76584375054407,1.41497334797082,-1.99677495899409,0.964201996462517,0.21816168),
c("GO:0006836","neurotransmitter transport",0.765491423143544,0.584145312403233,-7.17455976715549,2.13987908640124,-1.9643453060573,0.958325463959627,0.25788813),
c("GO:0007188","adenylate cyclase-modulating G protein-coupled receptor signaling pathway",1.29071911493546,-5.79458446966211,-2.56261814850858,2.3654879848909,-2.68190945327638,0.949321864093801,0.18703818),
c("GO:0007205","protein kinase C-activating G protein-coupled receptor signaling pathway",0.150863273174275,-5.69723196519518,-2.3135142337185,1.44715803134222,-1.7257448129025,0.957861810503738,0.46130634),
c("GO:0007215","glutamate receptor signaling pathway",0.251438788623792,-6.26811413122529,-2.13904712315016,1.66275783168157,-1.86225294863128,0.958577304333232,0.16104596),
c("GO:0007422","peripheral nervous system development",0.441414762250657,6.96612615644302,0.0636398722251418,1.90308998699194,-1.32287076903484,0.872849948412541,0.29863468),
c("GO:0007423","sensory organ development",3.15695367938761,6.10969111756585,2.18781408021071,2.75281643118827,-2.49971542680995,0.878646316361696,0.40604278),
c("GO:0007498","mesoderm development",0.709616136782701,6.49225533365373,3.04890468349227,2.10720996964787,-1.54732046388612,0.899905501734192,0.47292223),
c("GO:0007517","muscle organ development",1.69860870536961,5.84043870641015,2.28710291290206,2.48429983934679,-4.26055220215839,0.865368177546251,0),
c("GO:0007584","response to nutrient",0.815779180868302,-3.96002912435358,-5.53227198417657,2.16731733474818,-1.7257448129025,0.980545405110369,0.28206616),
c("GO:0007586","digestion",0.6034530926971,7.86088606042176,-2.56691547859678,2.03742649794062,-1.91637502304802,0.931251779464927,0.15017573),
c("GO:0007588","excretion",0.100575515449517,6.31212709609918,-4.72794093785198,1.27875360095283,-2.70463694086573,0.902396515273543,0.35556712),
c("GO:0007611","learning or memory",1.51980778901492,6.15506005864049,-3.52807599596436,2.43616264704076,-2.28953783322947,0.865561910003403,0.47659633),
c("GO:0008015","blood circulation",2.25736156897804,6.23918848669896,-3.26728299968535,2.60745502321467,-4.05557526648478,0.861187312380152,0),
c("GO:0008016","regulation of heart contraction",1.12309325585294,-2.46282293572449,5.95818505658051,2.30535136944662,-3.42326275917434,0.910087776431035,0.03427581),
c("GO:0008277","regulation of G protein-coupled receptor signaling pathway",0.771078951779628,-6.07640944678339,1.99348075279892,2.14301480025409,-1.59983992629002,0.959091322325096,0.31878442),
c("GO:0009410","response to xenobiotic stimulus",2.33558696988322,-3.78796247356242,-5.1593856124923,2.6222140229663,-2.79428270668916,0.978488361468225,0.27495818),
c("GO:0009812","flavonoid metabolic process",0.0726378722690954,5.79425204404006,6.28666248381463,1.14612803567824,-4.26055220215839,0.987167652613172,0.05674516),
c("GO:0010092","specification of animal organ identity",0.100575515449517,7.35458707636981,1.49785461016715,1.27875360095283,-1.93182106047476,0.853710634209342,0.49312959),
c("GO:0010469","regulation of signaling receptor activity",1.00575515449517,-6.20887885535914,1.69289314655418,2.25767857486918,-1.3263573256595,0.958068577641357,0.32904624),
c("GO:0010752","regulation of cGMP-mediated signaling",0.0726378722690954,-6.32793106371976,1.26146916276248,1.14612803567824,-1.36515061825242,0.966433858263192,0.24958217),
c("GO:0010817","regulation of hormone levels",2.96697770576074,4.65667560662221,-6.62957840753704,2.72591163229505,-2.70463694086573,0.955058514854944,0.39200783),
c("GO:0010874","regulation of cholesterol efflux",0.206738559535118,-2.31814765520377,-2.85220062396368,1.57978359661681,-1.7257448129025,0.937485108657568,0.43353308),
c("GO:0014074","response to purine-containing compound",0.787841537687881,-3.58879054363109,-5.73495642966574,2.15228834438306,-1.92368462403824,0.979232679309585,0.3456412),
c("GO:0015849","organic acid transport",1.55333296083142,1.01636546508268,-6.72556370274904,2.4456042032736,-1.84676026296051,0.946527611623491,0.44614824),
c("GO:0015850","organic hydroxy compound transport",0.933117282226071,1.05923855552697,-6.93085950644161,2.22530928172586,-3.21787162958139,0.949144184815786,0.26347282),
c("GO:0016202","regulation of striated muscle tissue development",0.0949879868134324,0.429107150566409,7.05682078114771,1.25527250510331,-2.20817519958317,0.918542515731555,0.02629901),
c("GO:0019216","regulation of lipid metabolic process",1.86623456445214,-3.62347122137843,3.34891436776078,2.52504480703685,-2.49971542680995,0.968438861894352,0.16137261),
c("GO:0019218","regulation of steroid metabolic process",0.514052634519752,-2.98504987760485,2.80150220641739,1.96848294855394,-3.04537324772516,0.952512391105708,0.10272633),
c("GO:0019755","one-carbon compound transport",0.139688215902106,1.60487879667056,-7.03703154368732,1.41497334797082,-2.18840001414497,0.957064221798406,0.35060536),
c("GO:0019932","second-messenger-mediated signaling",1.30748170084372,-5.60964439457604,-3.03850164175298,2.37106786227174,-2.78115001824625,0.950587163239691,0.44294819),
c("GO:0019935","cyclic-nucleotide-mediated signaling",0.307314074984634,-5.70484085506271,-3.20615854499475,1.7481880270062,-3.21787162958139,0.952143999984944,0.11947261),
c("GO:0021610","facial nerve morphogenesis",0.0558752863608426,7.78004156740587,0.900940524590307,1.04139268515823,-1.36515061825242,0.872814700095343,0.26282699),
c("GO:0021700","developmental maturation",1.50304520310667,6.17137394490066,3.81293746058343,2.43136376415899,-1.85247959816042,0.926070168624922,0.1892624),
c("GO:0022600","digestive system process",0.413477119070235,6.45316969771231,-4.05009771458776,1.8750612633917,-1.46034819096353,0.889922180766077,0.40973749),
c("GO:0030198","extracellular matrix organization",1.55333296083142,3.95771984300012,7.06755502565397,2.4456042032736,-2.04891279547666,0.996368069452248,0.00308906),
c("GO:0030213","hyaluronan biosynthetic process",0.0391127004525898,-2.31186213033081,0.784791584508627,0.903089986991944,-1.42912817764222,0.979171287751123,0.05405004),
c("GO:0030301","cholesterol transport",0.374364418617645,1.29104020010589,-7.04321140761525,1.83250891270624,-2.27947454080331,0.947633766274166,0.38428589),
c("GO:0031047","RNA-mediated gene silencing",0.6034530926971,-4.62944313463639,4.59424297939257,2.03742649794062,-2.53138249177541,0.943361230127637,0.48930479),
c("GO:0031589","cell-substrate adhesion",1.08956808403643,5.08345441507342,6.49095719725848,2.29225607135648,-1.56904147223031,0.998736526307377,0.00332662),
c("GO:0031649","heat generation",0.0391127004525898,1.39297622779495,-2.03986043780673,0.903089986991944,-1.48162572879818,0.931770850240005,0.37049993),
c("GO:0032331","negative regulation of chondrocyte differentiation",0.134100687266022,-1.23040037111497,6.0149970511769,1.39794000867204,-2.04138349018154,0.87196250331764,0.38542901),
c("GO:0032526","response to retinoic acid",0.609040621333184,-3.3593776106175,-5.81914683193113,2.04139268515822,-2.20037558246302,0.979700043830852,0.23847894),
c("GO:0034405","response to fluid shear stress",0.178800916354696,3.7056850194674,5.95285335947068,1.51851393987789,-1.37752983210496,0.989685935160617,0),
c("GO:0035195","miRNA-mediated gene silencing",0.150863273174275,-4.72690360951438,4.82068960449676,1.44715803134222,-3.74542653441305,0.945501392048547,0.02749754),
c("GO:0035249","synaptic transmission, glutamatergic",0.201151030899033,-6.33943785633624,-1.46718583973255,1.56820172406699,-2.38379025753742,0.98055067665538,0.14742161),
c("GO:0035265","organ growth",0.558752863608426,4.49350467673919,-0.304414001765597,2.00432137378264,-2.63967177755642,0.893832576306982,0.16904309),
c("GO:0035810","positive regulation of urine volume",0.0726378722690954,5.56991461648043,-5.22440318020112,1.14612803567824,-1.55511242989001,0.879040373494156,0.34506566),
c("GO:0042044","fluid transport",0.189975973626865,1.7235333175102,-6.4471205798498,1.54406804435028,-3.0428277311099,0.963263192969693,0.22441029),
c("GO:0042445","hormone metabolic process",1.15661842766944,4.4144810085584,-6.73566323792028,2.31806333496276,-3.75506111118411,0.939019289765739,0.06519253),
c("GO:0042749","regulation of circadian sleep/wake cycle",0.117338101357769,-2.84525554330179,6.06847490835734,1.34242268082221,-1.9643453060573,0.928685380288758,0.28295463),
c("GO:0042908","xenobiotic transport",0.268201374532044,-0.118214263377779,-7.09204834656844,1.69019608002851,-2.16395247677816,0.962151085269412,0.23185799),
c("GO:0043062","extracellular structure organization",1.55892048946751,4.32175286041174,6.94363973674264,2.44715803134222,-1.90451296595866,0.996367225446676,0.19522046),
c("GO:0043535","regulation of blood vessel endothelial cell migration",0.502877577247583,-2.54785413169048,6.27328505271308,1.95904139232109,-3.23532238187303,0.892288453170895,0.3250518),
c("GO:0043542","endothelial cell migration",0.396714533161982,4.21177088940761,-2.80396882310355,1.85733249643127,-1.99228643642326,0.917358040523716,0.14341749),
c("GO:0045165","cell fate commitment",1.39129463038498,4.84902884294593,2.94865344232101,2.39794000867204,-1.34744304343467,0.918911301192298,0.18751131),
c("GO:0045744","negative regulation of G protein-coupled receptor signaling pathway",0.279376431804213,-5.61443214045163,2.68128778769729,1.70757017609794,-1.52165862054725,0.94105782160241,0.28484222),
c("GO:0046068","cGMP metabolic process",0.0949879868134324,-3.35035837150487,0.0319241694376145,1.25527250510331,-2.1489591069502,0.942956497561872,0.39380828),
c("GO:0046683","response to organophosphorus",0.709616136782701,-3.42270559571209,-5.51351776995585,2.10720996964787,-1.45676877944534,0.979424713185515,0.35103626),
c("GO:0048103","somatic stem cell division",0.0558752863608426,0.548231067741235,2.23452432628871,1.04139268515823,-1.52985599606873,0.999024921159948,0.00227884),
c("GO:0048608","reproductive structure development",1.63714589037269,6.50399111682628,-0.204587612915734,2.46834733041216,-2.29627223803032,0.85602730240391,0.21965244),
c("GO:0048634","regulation of muscle organ development",0.122925629993854,0.752185539467549,6.83931448892675,1.36172783601759,-2.13412659559876,0.934204855886435,0.29477838),
c("GO:0048638","regulation of developmental growth",1.77124657763871,0.500664215994835,6.40947612072247,2.50242711998443,-2.1527430581423,0.911249355515202,0.38293694),
c("GO:0048738","cardiac muscle tissue development",1.01693021176734,6.44083638284308,0.871479011240723,2.26245108973043,-2.50646579940273,0.802941501078182,0.49272316),
c("GO:0050678","regulation of epithelial cell proliferation",2.07856065262334,-0.00527388589808671,0.672528641659959,2.57170883180869,-1.58055615441241,0.960370437650861,0.3982889),
c("GO:0050769","positive regulation of neurogenesis",1.27395652902721,-0.640856895293428,6.29758036702089,2.35983548233989,-1.66314878302276,0.866489519515338,0.47923425),
c("GO:0050795","regulation of behavior",0.419064647706319,-2.50869058370696,5.64453486022161,1.88081359228079,-2.1489591069502,0.924908144981633,0.31910398),
c("GO:0050803","regulation of synapse structure or activity",1.33541934402414,4.47374594221174,-6.55981317047937,2.38021124171161,-1.85150509358857,0.958462167891565,0.39920112),
c("GO:0050804","modulation of chemical synaptic transmission",2.58702575850701,-5.86434380455255,1.78834012390457,2.66651798055488,-4.20429489467031,0.94232813653925,0),
c("GO:0050879","multicellular organismal movement",0.234676202715539,3.77436118971475,-3.65916328981007,1.63346845557959,-2.49971542680995,0.936882238392048,0.13576991),
c("GO:0050909","sensory perception of taste",0.402302061798067,6.13780226781809,-4.06194830215599,1.86332286012046,-2.60914979118996,0.880571701586321,0.40853122),
c("GO:0051147","regulation of muscle cell differentiation",0.754316365871375,0.20342069799152,6.52594856811316,2.13353890837022,-2.16705472256452,0.916512241175739,0.28836266),
c("GO:0052695","cellular glucuronidation",0.111750572721685,-4.24518258513839,-0.621663030943782,1.32221929473392,-1.99677495899409,0.936660227302158,0.39972468),
c("GO:0055067","monovalent inorganic cation homeostasis",0.860479409956976,0.731045603547893,-2.18470187796117,2.19033169817029,-1.73305745911618,0.979256632577348,0),
c("GO:0060021","roof of mouth development",0.508465105883668,5.56488300754953,3.53142300835079,1.96378782734556,-1.36609852041436,0.925104164639635,0.19021315),
c("GO:0060324","face development",0.284963960440297,4.50054632409546,2.53435705145712,1.7160033436348,-1.6775349791946,0.922309423400766,0.47935879),
c("GO:0060325","face morphogenesis",0.167625859082528,7.37912557929358,2.83833371646692,1.49136169383427,-1.93182106047476,0.900519174864627,0.25624278),
c("GO:0060536","cartilage morphogenesis",0.0558752863608426,7.14687838584625,1.88870281291291,1.04139268515823,-1.83249671545882,0.847603632776675,0.46832912),
c("GO:0060537","muscle tissue development",1.82153433536347,6.27607345204115,2.7096395990068,2.51454775266029,-2.50646579940273,0.890303041693941,0.22024948),
c("GO:0060627","regulation of vesicle-mediated transport",2.96139017712466,-1.997327039838,-2.85103067906738,2.72509452108147,-2.13785836263929,0.925696488108353,0.04886252),
c("GO:0061217","regulation of mesonephros development",0.0279376431804213,1.14310147644069,6.62165057727058,0.778151250383644,-1.45241706573474,0.93739385159007,0.22559761),
c("GO:0061458","reproductive system development",1.65949600491703,6.03075509063846,0.109843288444302,2.47421626407626,-2.22030290976197,0.858071473132524,0.31991197),
c("GO:0062014","negative regulation of small molecule metabolic process",0.553165334972342,-4.59146663171938,4.27423900755455,2,-2.13412659559876,0.941957675972269,0.25672835),
c("GO:0070050","neuron cellular homeostasis",0.346426775437224,0.646513334021317,-1.84983382952471,1.79934054945358,-1.46034819096353,0.981467940365849,0.44805175),
c("GO:0070633","transepithelial transport",0.162038330446444,1.15694615018763,-5.93155296125089,1.47712125471966,-1.83303868300578,0.9637548141646,0.22113379),
c("GO:0070997","neuron death",0.586690506788847,-1.19929189791596,2.28376993450666,2.02530586526477,-1.58055615441241,0.995463392580937,0.00310526),
c("GO:0072001","renal system development",1.7041962340057,6.35910200153331,0.0623127187400541,2.48572142648158,-1.32895724080482,0.857684341477459,0.34435283),
c("GO:0072009","nephron epithelium development",0.581102978152763,6.27760639192205,1.07407140639413,2.02118929906994,-1.92368462403824,0.82770221972614,0.4625996),
c("GO:0072488","ammonium transmembrane transport",0.0614628149969269,-0.0221554220224609,-6.07069512840263,1.07918124604762,-1.46034819096353,0.941286935572732,0.48140004),
c("GO:0090130","tissue migration",0.614628149969269,7.64805688575324,-3.01180519884372,2.04532297878666,-1.39663709888659,0.931132435105635,0.15048594),
c("GO:0090596","sensory organ morphogenesis",1.50304520310667,6.89399135430244,2.18019389330864,2.43136376415899,-2.37819104842463,0.850297468521869,0.36961962),
c("GO:0097154","GABAergic neuron differentiation",0.0949879868134324,5.28737778585609,0.878204807550022,1.25527250510331,-1.72716681366898,0.883713353835522,0.23725621),
c("GO:0098693","regulation of synaptic vesicle cycle",0.0726378722690954,-1.77921936858652,-3.1396608126613,1.14612803567824,-1.42912817764222,0.941605640189219,0.3913386),
c("GO:0098739","import across plasma membrane",0.877241995865229,0.524931780842644,-6.24583712440309,2.19865708695442,-1.66765981801605,0.945224687888778,0.26170552),
c("GO:0099177","regulation of trans-synaptic signaling",2.5926132871431,-5.94251353030622,1.52721455107109,2.66745295288995,-4.17001980844517,0.954871081402719,0.37168699),
c("GO:0099504","synaptic vesicle cycle",0.782254009051796,0.338151667667095,-6.92095045220575,2.14921911265538,-1.3412572564045,0.957193869982469,0.2584875),
c("GO:1900449","regulation of glutamate receptor signaling pathway",0.0335251718165056,-6.25961745335175,0.874418952527031,0.845098040014257,-2.05040951379235,0.968305542954211,0.23302536),
c("GO:1901215","negative regulation of neuron death",1.20131865675812,-5.20840148438095,4.21847222291953,2.33445375115093,-1.54732046388612,0.946637449721833,0.15804545),
c("GO:1901861","regulation of muscle tissue development",0.257026317259876,0.763611791624372,6.14891782699052,1.67209785793572,-2.07459250949595,0.930273889636451,0.31481626),
c("GO:1903587","regulation of blood vessel endothelial cell proliferation involved in sprouting angiogenesis",0.0949879868134324,-0.246349339527133,0.478288815372637,1.25527250510331,-3.52445024985021,0.960574303082252,0.03302747),
c("GO:1903670","regulation of sprouting angiogenesis",0.217913616807286,-0.786487923660683,6.20839119370694,1.60205999132796,-1.76862559126105,0.8884764484391,0.31009857),
c("GO:1905207","regulation of cardiocyte differentiation",0.150863273174275,0.0417258488562128,6.79086679524862,1.44715803134222,-1.80141487373306,0.926874583233544,0.38941692),
c("GO:1905332","positive regulation of morphogenesis of an epithelium",0.201151030899033,0.39183474168121,5.82970910519392,1.56820172406699,-1.62873391803101,0.919368532364166,0.45678535),
c("GO:2000725","regulation of cardiac muscle cell differentiation",0.0894004581773482,0.101007283287078,6.22538966589414,1.23044892137827,-1.83073863512919,0.920445569520215,0.37230403),
c("GO:2001256","regulation of store-operated calcium entry",0.0838129295412639,-1.82634241739757,-2.51993780956813,1.20411998265592,-1.42912817764222,0.944944618968702,0.39661979));

one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$log_size <- as.numeric( as.character(one.data$log_size) );
one.data$value <- as.numeric( as.character(one.data$value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);

chosen <- read_excel("/scratch/trcanmed/DE_RNASeq/local/share/data/chosen_for_all_revigo.xlsx", 
                  sheet = "LMO_LMX_up")
chosen$chosen <- "YES"
chosen <- rbind(chosen , c("muscle organ development", "YES"))

one.data <- merge(one.data, chosen, by = "description", all.x = TRUE)
one.data$chosen[is.na(one.data$chosen)] <- "NO"
one.data <- one.data[, c(2,1,3,4,5,6,7,8,9,10)]
rownames(one.data) <- one.data$term_ID
one.data$new_log_size <- NA

for (i in rownames(one.data)) {
  if (one.data[i, "log_size"] < 1.98) {
    one.data[i, "new_log_size"] <- 0.78
  } else if (one.data[i, "log_size"] > 1.98 & one.data[i, "log_size"] < 2.5 | one.data[i, "log_size"] == 1.98) {
    one.data[i, "new_log_size"] <- 1.98
  } else {
    one.data[i, "new_log_size"] <- 3.0
  }
}

# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below
textSize <- 5
largerSize <- textSize + 2


unmute_theme <- theme_bw() +
  theme(
    text = element_text(size = textSize, family='sans'),
    axis.title = element_text(size = largerSize),
    axis.text.x = element_text(size = textSize, color="black"),#, angle = 90, vjust = 0.5, hjust=1)
    axis.text.y = element_text(size = textSize, color="black"),
    plot.title = element_text(size = largerSize, hjust = 0.5),
    legend.title = element_text(size=largerSize),
    legend.text = element_text(size=textSize)
  )


p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point(aes( plot_X, plot_Y, colour = value, size = new_log_size))# + scale_size_area();
p1 <- p1 + scale_colour_gradient(low = "red", high = "yellow")#, limits = c( min(one.data$value), 5) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = new_log_size), shape = 21, fill = "transparent", colour = I (alpha ("white", 0.6) ))# + scale_size_area();
#p1 <- p1 + scale_size(one.data$new_log_size) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
p1 <- p1 + scale_size_continuous(breaks = c(0.78, 1.98, 3.0)) + theme_bw()
ex <- one.data [ one.data$chosen == "YES", ];
#ex <- one.data [ one.data$dispensability < 0.15, ]
p1 <- p1 + geom_label_repel(data = ex, aes(plot_X, plot_Y, label = description), color = 'black', size = 3,
                            box.padding = unit(0.35, "lines"),
                            point.padding = unit(0.5, "lines"),
                            segment.color = 'grey50'
)+unmute_theme;
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y", size = "log_size");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);

ggsave("revigo_lmo_lmx_up.pdf", width = 11.69, height = 8.27)
p1 <- p1 + unmute_theme
dev.off()
